library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
#interpolate missing values for all columns
#cds_spread_data <- cds_spread_data %>%
#  transmute(across(is.numeric, list(~na.approx(.))))
cds_spread_data <- cds_spread_data %>%
transmute_at(vars(`Timestamp`), list(~na.approx(.)))
View(cds_spread_data)
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
cds_spread_data <- cds_spread_data %>%
transmute_at(vars(2:7), list(~na.approx(.)))
View(cds_spread_data)
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
View(cds_spread_data)
cds_spread_data <- cds_spread_data %>%
transmute_at(vars(2:7), list(~na.approx(.)))
View(cds_spread_data)
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
cds_spread_data <- cds_spread_data %>%
mutate(across(is.numeric, list(~na.approx(.))))
View(cds_spread_data)
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
cds_spread_data <- cds_spread_data %>%
mutate(across(!`Timestamp`, list(~na.approx(.))))
View(cds_spread_data)
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
View(cds_spread_data)
cds_spread_data <- cds_spread_data %>%
transmute(across(!`Timestamp`, list(~na.approx(.))))
View(cds_spread_data)
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
View(cds_spread_data)
cds_spread_data <- cds_spread_data %>%
transmute(keep = `Timestamp`, across(!`Timestamp`, list(~na.approx(.))))
View(cds_spread_data)
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
View(cds_spread_data)
cds_spread_data <- cds_spread_data %>%
transmute(.keep = `Timestamp`, across(!`Timestamp`, list(~na.approx(.))))
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
View(cds_spread_data)
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
cds_spread_data <- cds_spread_data %>%
transmute(Date = `Timestamp`, across(!`Timestamp`, list(~na.approx(.))))
View(cds_spread_data)
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
#interpolate missing values for all columns
cds_spread_data <- cds_spread_data %>%
transmute(across(!Timestamp, list(~na.approx(.))))
View(cds_spread_data)
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
View(cds_spread_data)
#interpolate missing values for all columns
cds_spread_data %>%
transmute(across(!Timestamp, list(~na.approx(.))))
View(cds_spread_data)
cds_spread_data %>%
transmute(across(!Timestamp, list(~na.approx(.))))
cds_spread_data %>%
mutate(across(!Timestamp, list(~na.approx(.))))
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
View(cds_spread_data)
cds_spread_data <- cds_spread_data %>%
mutate_at(c(`Credit Suisse`, `BNP`, `Deutsche Bank`,`Societe Generale`, `HSBC`, `UBS`), list(~na.approx(.)))
cds_spread_data <- cds_spread_data %>%
mutate_at(cds_spread_data, c(`Credit Suisse`, `BNP`, `Deutsche Bank`,`Societe Generale`, `HSBC`, `UBS`), list(~na.approx(.)))
cds_spread_data <- cds_spread_data %>%
mutate_at(.vars = c(`Credit Suisse`, `BNP`, `Deutsche Bank`,`Societe Generale`, `HSBC`, `UBS`), list(~na.approx(.)))
View(cds_spread_data)
cds_spread_data <- cds_spread_data %>%
mutate_at(.vars = c('Credit Suisse', `BNP`, `Deutsche Bank`,`Societe Generale`, `HSBC`, `UBS`), list(~na.approx(.)))
cds_spread_data <- cds_spread_data %>%
mutate_at(.vars = c('Credit Suisse', 'BNP', 'Deutsche Bank', 'Societe Generale', 'HSBC', 'UBS'), list(~na.approx(.)))
View(cds_spread_data)
View(cds_spread_data)
cds_spread_data <- cds_spread_data %>%
mutate(across(is.numeric, list(perc_change = ~(./lag(.) - 1))))
View(cds_spread_data)
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
#interpolate missing values for all columns
cds_spread_data <- cds_spread_data %>%
mutate_at(.vars = c('Credit Suisse', 'BNP', 'Deutsche Bank', 'Societe Generale', 'HSBC', 'UBS'), list(~na.approx(.)))
cds_spread_data <- cds_spread_data %>%
mutate(across(is.numeric, list(ret = ~(./lag(.) - 1))))
View(cds_spread_data)
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
View(missing_values)
View(cds_spread_data)
pseudo.uniform = function(X){
Fhat <- kcde(X)
predict(Fhat, x=X)
}
F_Credit_Suisse = pseudo.uniform(cds_spread_data$`Credit Suisse_ret`)
F_Credit_Suisse = pseudo.uniform(cds_spread_data$`Credit Suisse_ret`)
F_Credit_Suisse = pseudo.uniform(cds_spread_data$`Credit Suisse`)
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
#interpolate missing values for all columns
cds_spread_data <- cds_spread_data %>%
mutate_at(.vars = c('Credit Suisse', 'BNP', 'Deutsche Bank', 'Societe Generale', 'HSBC', 'UBS'), list(~na.approx(.)))
# show cds dataframe
#cds_spread_data
# plot with gaps
#plot(cds_spread_data$`Level Banco Santander`, type='o', pch=10, col='steelblue', xlab='Time Stamp', ylab='Price')
# plot without gaps
#plot(cds_spread_data$`Level Banco Santander`, type='o', pch=10, col='chocolate4', xlab='Time Stamp', ylab='Price')
# compute returns
cds_spread_data <- cds_spread_data %>%
mutate(across(is.numeric, list(ret = ~(./lag(.) - 1))))
F_Credit_Suisse <- pseudo.uniform(cds_spread_data$`Credit Suisse`)
pseudo.uniform = function(X){
Fhat <- kcde(X)
predict(Fhat, x=X)
}
F_Credit_Suisse <- pseudo.uniform(cds_spread_data$`Credit Suisse`)
plot(F_Credit_Suisse)
ks.plot(F_Credit_Suisse)
fhat_credit_suisse <- pseudo.uniform(cds_spread_data$`Credit Suisse`)
histde(fhat_credit_suisse, plot = TRUE)
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
#interpolate missing values for all columns
cds_spread_data <- cds_spread_data %>%
mutate_at(.vars = c('Credit Suisse', 'BNP', 'Deutsche Bank', 'Societe Generale', 'HSBC', 'UBS'), list(~na.approx(.)))
# show cds dataframe
#cds_spread_data
# plot with gaps
#plot(cds_spread_data$`Level Banco Santander`, type='o', pch=10, col='steelblue', xlab='Time Stamp', ylab='Price')
# plot without gaps
#plot(cds_spread_data$`Level Banco Santander`, type='o', pch=10, col='chocolate4', xlab='Time Stamp', ylab='Price')
# compute returns
cds_spread_data <- cds_spread_data %>%
mutate(across(is.numeric, list(ret = ~(./lag(.) - 1))))
cds_spread_data
fhat_credit_suisse <- pseudo.uniform(cds_spread_data$`Credit Suisse`)
pseudo.uniform = function(X){
Fhat <- kcde(X)
predict(Fhat, x=X)
}
fhat_credit_suisse <- pseudo.uniform(cds_spread_data$`Credit Suisse`)
histde(fhat_credit_suisse)
plot(histde)
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
#interpolate missing values for all columns
cds_spread_data <- cds_spread_data %>%
mutate_at(.vars = c('Credit Suisse', 'BNP', 'Deutsche Bank', 'Societe Generale', 'HSBC', 'UBS'), list(~na.approx(.)))
# show cds dataframe
#cds_spread_data
# plot with gaps
#plot(cds_spread_data$`Level Banco Santander`, type='o', pch=10, col='steelblue', xlab='Time Stamp', ylab='Price')
# plot without gaps
#plot(cds_spread_data$`Level Banco Santander`, type='o', pch=10, col='chocolate4', xlab='Time Stamp', ylab='Price')
# compute returns
cds_spread_data <- cds_spread_data %>%
mutate(across(is.numeric, list(ret = ~(./lag(.) - 1))))
cds_spread_data
# compute empirical CDF of the CDS spread return series
fhat_credit_suisse <- pseudo.uniform(cds_spread_data$`Credit Suisse`)
# Functions
pseudo.uniform = function(X){
Fhat <- kcde(X)
predict(Fhat, x=X)
}
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
#interpolate missing values for all columns
cds_spread_data <- cds_spread_data %>%
mutate_at(.vars = c('Credit Suisse', 'BNP', 'Deutsche Bank', 'Societe Generale', 'HSBC', 'UBS'), list(~na.approx(.)))
# show cds dataframe
#cds_spread_data
# plot with gaps
#plot(cds_spread_data$`Level Banco Santander`, type='o', pch=10, col='steelblue', xlab='Time Stamp', ylab='Price')
# plot without gaps
#plot(cds_spread_data$`Level Banco Santander`, type='o', pch=10, col='chocolate4', xlab='Time Stamp', ylab='Price')
# compute returns
cds_spread_data <- cds_spread_data %>%
mutate(across(is.numeric, list(ret = ~(./lag(.) - 1))))
cds_spread_data
# compute empirical CDF of the CDS spread return series
fhat_credit_suisse <- pseudo.uniform(cds_spread_data$`Credit Suisse`)
View(cds_spread_data)
histde(fhat_credit_suisse)
plot(x=x)
plot(histde)
plot(histde(fhat_credit_suisse))
plot(fhat_credit_suisse, xlab, ylab="Distribution function", add=FALSE, drawpoints=FALSE,
col.pt=4, jitter=FALSE, alpha=1, ...)
plot(fhat_credit_suisse, xlab, ylab="Distribution function", add=FALSE, drawpoints=FALSE,
col.pt=4, jitter=FALSE, alpha=1)
plot(fhat_credit_suisse, ylab="Distribution function", add=FALSE, drawpoints=FALSE,
col.pt=4, jitter=FALSE, alpha=1)
plot(fhat_credit_suisse, ylab="Distribution function", add=FALSE, drawpoints=FALSE,
col.pt=2, jitter=FALSE, alpha=1)
plot(fhat_credit_suisse, ylab="Distribution function", add=FALSE, drawpoints=FALSE,
col.pt=2, jitter=FALSE, alpha=1)
fhat_credit_suisse <- pseudo.uniform(cds_spread_data$`Credit Suisse`)
fhat_credit_suisse
pairs.panels(cds_spread_data[,1:7],
method = "pearson", # correlation method
hist.col = "#00AFBB",
density = TRUE,  # show density plots
ellipses = TRUE # show correlation ellipses
pairs.panels(cds_spread_data[,1:7],
pairs.panels(cds_spread_data[,1:3],
method = "pearson", # correlation method
hist.col = "#00AFBB",
density = TRUE,  # show density plots
ellipses = TRUE # show correlation ellipses
)
pairs.panels(cds_spread_data[,1:3],
method = "pearson", # correlation method
hist.col = "#00AFBB",
density = TRUE#,  # show density plots
#ellipses = TRUE # show correlation ellipses
)
# Load cds spreads from Excel sheet
library(readxl) # Excel reader package
library(dplyr) # Dataframe manipulation package
library(zoo) # Dataframe manipulation package
library(ks) # kernel smoothing package, alternative to MATLAB ksdensity function
library(psych) # to plot nice scatterplot matrices
# set path to data
data.path <- file.path(here(), 'data')
# read in Excel file, tab CDS_spreads_history into R dataframe
cds_spread_data=read_excel(file.path(data.path, 'default_basket_data.xlsx'),
'CDS_spreads_history',
range = 'E21:N1853')
# count missing values
missing_values <- cds_spread_data %>% select(is.numeric) %>%
summarise_all(list(~(sum(is.na(.)))))
# Drop Banco Santander, Standard Chartered, Danske Bank
cds_spread_data <- subset(cds_spread_data, select = -c(`Banco Santander`, `Standard Chartered`, `Danske Bank`))
#interpolate missing values for all columns
cds_spread_data <- cds_spread_data %>%
mutate_at(.vars = c('Credit Suisse', 'BNP', 'Deutsche Bank', 'Societe Generale', 'HSBC', 'UBS'), list(~na.approx(.)))
# show cds dataframe
#cds_spread_data
# plot with gaps
#plot(cds_spread_data$`Level Banco Santander`, type='o', pch=10, col='steelblue', xlab='Time Stamp', ylab='Price')
# plot without gaps
#plot(cds_spread_data$`Level Banco Santander`, type='o', pch=10, col='chocolate4', xlab='Time Stamp', ylab='Price')
# compute returns
cds_spread_data <- cds_spread_data %>%
mutate(across(is.numeric, list(ret = ~(./lag(.) - 1))))
cds_spread_data
# scatter plot
pairs.panels(cds_spread_data[,1:3],
method = "pearson", # correlation method
hist.col = "#00AFBB",
density = TRUE,  # show density plots
ellipses = TRUE # show correlation ellipses
)
pairs.panels(cds_spread_data[,2:5],
method = "pearson", # correlation method
hist.col = "#00AFBB",
density = TRUE,  # show density plots
ellipses = TRUE # show correlation ellipses
)
pairs.panels(cds_spread_data[,2:6],
method = "pearson", # correlation method
hist.col = "#00AFBB",
density = TRUE,  # show density plots
ellipses = TRUE # show correlation ellipses
)
